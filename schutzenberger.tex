\section{Satz}
    Eine Sprache $L$ ist genau dann sternfrei, wenn $L$ von einem aperiodischen Monoid erkannt wird (bzw. $Synt(L)$ ist aperiodisch).
\section{Definition}
    Sei $M$ Monoid. $R\subseteq M$ ist
    \begin{itemize}
        \item Rechts-ideal, falls $RM=R$
        \item Links-ideal, falls $MR=R$
        \item Ideal, falls $MRM=R$
    \end{itemize}
    \subsection{Beispiel}
        \begin{itemize}
            \item für jedes Monoid $M$ sind $M$ und $\emptyset$ Ideale
            \item für $M=\Sigmas$ mit $a\in\Sigmas$ ist $\Sigmas a\Sigmas$ ein Ideal, $a\Sigmas$ ein Rechtsideal und $\Sigmas a$ ein Linksideal.
        \end{itemize}
\section{Definition: Green'sche Relationen}
    Wir definieren die sogenannten Green'schen Relationen auf $M$ via:
    \begin{itemize}
        \item $a\le_R b\Leftrightarrow aM\subseteq bM$
        \item $a\le_L b\Leftrightarrow Ma\subseteq Mb$
        \item $aIb\Leftrightarrow MaM=MbM$
        \item $aRb\Leftrightarrow aM=bM$
        \item $aLb\Leftrightarrow Ma=Mb$
    \end{itemize}
    \subsection{Lemma}
        \label{sub:sch-lemma-1}
        Sei $M$ aperiodisch und $p,q,r\in M$ mit $pqr=q$, dann ist auch $pq=qr=q$ (Bew. ÜB)
    \subsection{Lemma}
        \label{sub:sch-lemma-2}
        Sei $M$ aperiodisch und $a,b\in M$ mit $aIb$. Dann gilt:
        \begin{enumerate}
            \item $a\le_R b\Rightarrow aRb$
            \item $a\le_L b\Rightarrow aLb$
        \end{enumerate}
        \subsubsection{Beweis}
            Da $MaM=MbM$ gilt, gibt es $u,v\in M$ mit $b=uav$.
            \begin{enumerate}
                \item Wegen $aM\subseteq bM$ gibt es $p\in M$ mit $a=bp$. Also $b=uav=ubpv$, nach Lemma~\ref{sub:sch-lemma-1} ist also $ub=b$.
                Damit ist $b=bpv$, also $bM=bpvM\subseteq bpM\subseteq aM$. Also $bM=aM$, somit $aRb$
                \item symmetrisch
            \end{enumerate}
    \subsection{Lemma}
        \label{sub:sch-lemma-3}
        Sei $M$ aperiodisches Monoid und $p\in M$. Dann ist $\{p\}=(Mp\cap pM)\setminus J_p$ mit $J_p=\{s\in M\mid p\not\in MsM\}$
        \subsubsection{Beweis}
            \begin{itemize}
                \item[$\subseteq$] klar ($1\in M$)
                \item[$\supseteq$] Sei $x\in (Mp\cap pM)\setminus J_p$.\\
                Dann gibt es $q,r\in M$ mit $pq=x=rp$. Da $x\notin J_p$, ist $p=uxv$ für $u,v\in M$.\\
                Damit: $$p=uxv=(ur)p(v)=urp=ux=upq=pq=x\Rightarrow x\in\{p\}$$\qed
            \end{itemize}
\section{Beweis zum Satz von Schützenberger}
    Zu zeigen: ist $Synt(L)$ aperiodisch, so ist $L$ sternfrei.\\
    $Synt(L)$ endlich, da $L\in \textsc{Reg}$
    Sei $\varphi:\Sigmas\rightarrow M=Synt(L)$ ein Monomorphismus mit $M$ aperiodisch. Da $\varphi\ L$ erkennt, existiert eine endliche Teilmenge $P\subseteq M$ mit $\varphi^{-1}(P)=\bigcup\limits_{m\in P}\varphi^{-1}(m)=M$. Wir zeigen $\varphi^{-1}(\{m\})$ ist sternfrei $\forall m\in M$:\\
    Induktion über $r(m)=|M\setminus MmM|$:
    \begin{itemize}
        \item[$r(m)=0$:] Dann ist $M=MmM$ (Differenz leer, abgeschlossen). Damit gibt es $p,q\in M$ mit $1=pmq=pm1q=pm=p1m=m$. Folglich: $\varphi^{-1}(m)=\varphi^{-1}(1)\overset{(*)}{=}\{a\in\Sigma\mid\varphi(a)=1\}^*$, denn ist $w\in \Sigmas$ mit $|w|>1$ und $w=ua,\ a\in \Sigma$, dann ist $$\varphi(w)=\varphi(ua)=1\Leftrightarrow \varphi(u)\varphi(a)=1\Leftrightarrow \varphi(u)1\varphi(a)=1\Leftrightarrow \varphi(u)=1\wedge \varphi(a)=1$$
        $(*)$ folgt durch Induktion.\\
        Ist $B\subseteq \Sigma$, so ist $B^*$ sternfrei: $B^*=\overline{\overline{\emptyset}\overline{B}\overline{\emptyset}}$. Damit ist $\varphi^{-1}(m)$ sternfrei.
        \item[$r(m)>0$:] Wir zeigen: $\varphi^{-1}(m)=(U\Sigmas\cap \Sigmas V)\setminus(\Sigmas C\Sigmas\cup \Sigmas W\Sigmas)=K$ mit:
        \begin{itemize}
            \item $U=\bigcup\limits_{n,a)\in E} \varphi^{-1}(n)a\Sigmas$
            \item $V=\bigcup\limits_{n,a)\in F} \Sigmas a\varphi^{-1}(n)$
            \item $C=\{a\in\Sigma\mid m\not\in M\varphi(a)M\}$
            \item $W=\bigcup\limits_{(a,n,b)\in G}\Sigmas a\varphi^{-1}(n)b\Sigmas$
            \item $E=\{(n,a)\in M\times \Sigma\mid n\varphi(a)Rm,\ n\not\in mM\}$
            \item $F=\{(n,a)\in M\times \Sigma\mid \varphi(a)nLm,\ n\not\in Mm\}$
            \item $G=\{(a,n,b)\in \Sigma\times M\times \Sigma\mid m\in \left(M\varphi(a)nM\cap Mn\varphi(b)M\right)\setminus M\varphi(a)n\varphi(b)M\}$
        \end{itemize}
        Dann ist nur noch zu zeigen, dass $U,V,W,C$ sternfrei.
        \begin{itemize}
            \item[$\varphi^{-1}(m)\subseteq K$] Wir nehmen an $m\not=1$ (sonst $r(m)=0$). Sei $u\in\varphi^{-1}(m)$ und $p\in\Sigmas$ sei das kürzeste Präfix von $u$ mit $\varphi(p)Rm$.\\
            Da $\varphi(u)=m$ ist, muss es ein solches $p$ geben.
            \begin{itemize}
                \item Falls $p=\epsilon$, ist $1Rm$ also $M=mM$ und damit $m=1\ \lightning$ $\Rightarrow p\not=\epsilon$
                \item Falls $p=ra$, $a\in\Sigma,\ r\in\Sigmas$:\\
                Setze $n=\varphi(r)$. Dann ist $\varphi(p)=n\varphi(a)Rm$ aber nicht $nRm$ also $(n,a)\in E$ und somit $u\in U\Sigmas$
                \item Analog für $u\in\Sigmas V$
            \end{itemize}
            Es bleibt zu zeigen, dass $u\not\in \Sigmas C\Sigmas\cup \Sigmas W\Sigmas$.
            \begin{itemize}
                \item Angenommen $u\in\Sigmas C\Sigmas$, dann ist $u=sct$ mit $s,t\in\Sigmas,\ c\in C$. Aber: $m=\varphi(u)\in M\varphi(c)M$ im Widerspruch zu $c\in C \Rightarrow u\not\in \Sigmas C\Sigmas$
                \item  Angenommen $u\in\Sigmas W\Sigmas$, dann ist $u\in\Sigmas a\varphi^{-1}(n)b\Sigmas$ für ein $(a,n,b)\in G$.\\
            Damit ist $m=\varphi(u)\in M \varphi(a)n\varphi(b)M$ im Widerspruch zu $(a,n,b)\in G\ \lightning$ $\Rightarrow u\not\in\Sigmas W\Sigmas$
            \end{itemize}
            $\Rightarrow \varphi^{-1}(m)\subseteq K$
            \item[$K\subseteq\varphi^{-1}(m)$] Sei $u\in K$ und $s=\varphi(U)$. Da $u\in U\Sigmas$, ist $s\in n\varphi(s)M$ für ein $(n,a)\in E$. Also $n\varphi(a)Rm$, damit $s\in mM$.\\
            Analog $u\in\Sigmas V\Rightarrow s\in Mm$.\\
            Also $s\in mM\cap Mm$.\\
            Es gilt: $m\in MsM\Leftrightarrow s\not\in J_m$ (Definition in Lemma~\ref{sub:sch-lemma-3}) und mit dem Lemma folgt $s\in(mM\cap Mm)\setminus J_m=\{m\}$\\
            Also genügt zu zeigen $m\in MsM$.\\
            Angenommen $m\not\in MsM$.\\
            Dann gibt es $f\in\Sigmas$ minimal mit $s=vfw$ und $m\not\in M\varphi(f)M,\ v,w\in\Sigmas$
            \begin{itemize}
                \item Falls $f=\epsilon$ $\Rightarrow m\not\in M\ \lightning$
                \item Falls $f=a,a\in \Sigma$ $\Rightarrow a\in C\Rightarrow u\in\Sigmas C\Sigmas\Rightarrow u\not\in K\ \lightning$
                \item Falls $f=agb$ mit $a,b\in\Sigma,\ g\in\Sigmas$; setze $x=\varphi(g)$. Dann ist $\varphi(f)=\varphi(a)x\varphi(b)$ und $u\in M\varphi(a)xM\cap Mx\varphi(b)M$, da $f$ minimal. Also $(a,x,b)\in G$, damit $f\in W$ und $u \in\Sigmas W\Sigmas$ $\Rightarrow u\not\in K\ \lightning$
            \end{itemize}
            $\Rightarrow m\in MsM$, letztlich $K\subseteq \varphi^{-1}(m)$
        \end{itemize}
        \begin{itemize}
            \item $u,V,W,C$ sternfrei
            \begin{itemize}
                \item $C$ sternfrei, klar da endlich
                \item zu $U$ ($V$ analog):\\
                    $(n,a)\in E\Rightarrow n\varphi(a)Rm \Rightarrow Mn\varphi(a)M=MmM\subseteq MnM\\\Rightarrow r(n)\le r(m)$
                    \begin{itemize}
                        \item Ist $r(n)=r(m)$, so $MmM=MnM$, damit $mIn$. Da $mM=n\varphi(a)M\subseteq nM$, also $m\le_R n$, folgt mit Lemma~\ref{sub:sch-lemma-2} $nRm$, insbesondere $n\in mM\ \lightning$
                        \item Also $r(n)<r(m)$\\
                        $IV$: $\varphi^{-1}(n)$ ist sternfrei.\\
                        $\Rightarrow U$ ist sternfrei.
                    \end{itemize}
                \item zu $W$:\\
                    Sei $(a,n,b)\in G$. Dann ist $m\in M\varphi(a)nM\subseteq MnM$\\
                    $r(n)\le r(m)$
                    \begin{itemize}
                        \item Angenommen $r(n)=r(m)$. Dann ist $MnM=MmM$ also insbesondere $n\in MmM$. Da $m\in Mn\varphi(b) M$ ist dann auch $n\in Mn\varphi(b)M$ also $n=rn\varphi(b)s=n\varphi(b)s,\ r,s\in M$.\\
                        Analog $m\in M\varphi(a)nM\Rightarrow n=x\varphi(a)ny\Rightarrow n=x\varphi(a)n\varphi(b)sy\in M\varphi(a)n\varphi(b)M\ \lightning$ (Widerspruch zu $(a,n,b)\in G$)
                        \item[$\Rightarrow$] $r(n)<r(m)$
                    \end{itemize}
                    $IV:$ $\varphi^{-1}(n)$ sternfrei, damit $W$ sternfrei\qed
            \end{itemize}
        \end{itemize}
    \end{itemize}
